<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="target-densitydpi=device-dpi; width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta name="HandheldFriendly" content="true">
<title><?php echo $title ?></title>
<link href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,700' rel='stylesheet' type='text/css'>
<link href="<?php echo base_url();?>templates/css/butuhuang.css" rel="stylesheet" type="text/css">
<link href="<?php echo base_url();?>templates/css/template.css" rel="stylesheet" type="text/css">
<link href="<?php echo base_url();?>templates/css/jquery-ui.css" rel="stylesheet" type="text/css">
<link href="<?php echo base_url();?>templates/css/selectordie.css" rel="stylesheet" type="text/css">
<link href="<?php echo base_url();?>templates/css/jquery.jscrollpane.css" rel="stylesheet" type="text/css">
<link href="<?php echo base_url();?>templates/css/jquery-ui-slider-pips.css" rel="stylesheet" type="text/css">
<link href="<?php echo base_url();?>templates/css/validationEngine.jquery.css" rel="stylesheet" type="text/css">

<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.12.0/jquery.validate.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.12.0/additional-methods.js"></script>

<script src="<?php echo base_url();?>templates/js/jquery-ui.js"></script>
<script src="<?php echo base_url();?>templates/js/selectordie.js"></script>
<script src="<?php echo base_url();?>templates/js/jquery.mousewheel.js"></script>
<script src="<?php echo base_url();?>templates/js/mwheelIntent.js"></script>
<script src="<?php echo base_url();?>templates/js/jquery.jscrollpane.min.js"></script>
<script src="<?php echo base_url();?>templates/js/jquery-ui-slider-pips.js"></script>
<script src="<?php echo base_url();?>templates/js/main.js"></script>

</head>

<body>
    <div class="wrapper">
        <?php $this->load->view('common/header');?>
        <?php $this->load->view($content);?>
        <?php $this->load->view('common/footer');?>
    </div>

<script>
		function addCommas(nStr){
			nStr += '';
			var x = nStr.split('.');
			var x1 = x[0];
			var x2 = x.length > 1 ? '.' + x[1] : '';
			var rgx = /(\d+)(\d{3})/;
			while (rgx.test(x1)) {
				x1 = x1.replace(rgx,'$1' + '.' + '$2');
			}
			
			
			strs='Rp. ' + x1 + x2 +',-';
			return strs;
		}
		
		function calculate_loan(){
			
			
			val=parseInt($('#la_hidden').val());
	
			periode=parseInt($("#sliderMonth").text());
			var interestFee = (1/100)*val*periode;
			total_repayable = interestFee + val
			
			new_interestfee=addCommas(interestFee);
			new_total_repayable=addCommas(total_repayable);
			
			
		
			

var now = new Date(); 
now.setDate(now.getDate() + parseInt(periode));

new_date=$.datepicker.formatDate("dd MM yy",now);
			//console.log(new_date);
			
			
			$("#due_date").text(new_date);
			
			
			$("#interest").text(new_interestfee );
			$('#repayable').text(new_total_repayable );
		}
		$(document).ready(function(){
			$("#sliderPrice").slider({
				min: 1000000, 
				max: 2000000, 
				value: 1000000, 
				step: 100000 
			}).slider("float",{
				prefix: "Rp&nbsp;",
		        suffix: ",-"
			}).on("slidechange", function( e, ui ) {
				
				setTimeout(function() {
					var val = ui.value
					$("span.info.price, #loan_amount").html(addCommas(val));
					$('#la_hidden').html(val);
					calculate_loan();
				}, 200 );
					
				/*setTimeout(function() {
				var val = ui.value
				periode=30*parseInt($("#sliderMonth").text());
				var interestFee = (1/100)*val*periode
				$("#interest").html('Rp '+interestFee+',-' );}, 200 );*/
			});
			
			$("#sliderMonth").slider({
				min: 1, 
				max: 30, 
				value: 1, 
				step: 1 
			}).slider("float",{
		        suffix: "&nbsp;Hari"
			}).on("slidechange", function( e, ui ) {
            
            setTimeout(function() {
                var valDay = ui.value
                $("span.info.month").html(valDay +' Bulan');
				periode = parseInt(valDay);
				$("#periode_hidden").val(periode);
				calculate_loan();
				}, 200 );
			});
		});
		$(window).bind('load', function(){
		});
		$(document).ready(function(e) {
            
			calculate_loan();
        });


</script>


</body>
</html>

